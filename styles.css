
:root{
  color-scheme:light dark;
  --bg:#0b1220;
  --ink:#e8f1ff;
  --border:#1e2a3d;
  --muted:#96b3ff80;
  --primary:#3aa0ff;
  --primary-ink:#001021;
  --ok:#2ecc71;
  --err:#ff5d6c;
  --shadow:0 8px 30px rgba(4,16,40,.35);
  --outline-bg:color-mix(in oklab, var(--bg) 92%, #0000);
  --input-bg:color-mix(in oklab, var(--bg) 86%, #0000);
  --input-focus:#5aa8ff;
}
@media (prefers-color-scheme: light){
  :root{
    --bg:#f6f9ff;
    --ink:#0b1220;
    --border:#cdd9ee;
    --muted:#2d5bff1a;
    --primary:#2563eb;
    --primary-ink:#ffffff;
    --shadow:0 8px 28px rgba(34,62,140,.18);
    --outline-bg:#ffffff;
    --input-bg:#ffffff;
    --input-focus:#2b78ff;
  }
}
*{box-sizing:border-box}
html,body{margin:0;padding:0;background:var(--bg);color:var(--ink);font:16px/1.5 system-ui,-apple-system,Segoe UI,Roboto,sans-serif;overflow-x:hidden}
header{
  position:sticky;top:0;padding:12px 16px;border-bottom:1px solid var(--border);
  backdrop-filter:blur(8px);
  background:color-mix(in oklab, var(--bg) 85%, transparent);
  display:flex;align-items:center;gap:8px
}
h1{font-size:18px;margin:0;flex:1}
#miniCounter{font-size:13px;opacity:.95;border:1px solid var(--border);padding:6px 10px;border-radius:999px;background:var(--muted)}
#dirtyBadge{font-size:12px;padding:4px 8px;border-radius:999px;border:1px solid var(--border);background:color-mix(in oklab, var(--bg) 85%, #0000)}
main{padding:16px;display:grid;gap:16px}
.card{border:1px solid var(--border);border-radius:16px;padding:16px;background:linear-gradient(180deg, color-mix(in oklab, var(--bg) 96%, #0000), color-mix(in oklab, var(--bg) 92%, #0000))}
.toolbar{display:flex;gap:10px;flex-wrap:wrap}
input,button,textarea{font:inherit;font-size:16px;border-radius:14px;min-height:44px}
input,textarea{padding:12px 14px;background:var(--input-bg);color:var(--ink);border:2px solid color-mix(in oklab, var(--border) 85%, #7aa2ff)}
input:focus,textarea:focus{outline:none;border-color:var(--input-focus);box-shadow:0 0 0 3px color-mix(in oklab, var(--input-focus) 35%, transparent)}
button{padding:12px 16px;color:var(--ink);border:1px solid var(--border)}
button.primary{background:var(--primary);color:var(--primary-ink);border-color:color-mix(in oklab, var(--primary) 60%, #000);box-shadow:0 4px 18px rgba(38,132,255,.24)}
button.outline{background:var(--outline-bg);border:2px solid color-mix(in oklab, var(--border) 70%, #7aa2ff);box-shadow:0 1px 0 rgba(0,0,0,.05)}
label{font-weight:600}
.kv{display:grid;grid-template-columns:120px 1fr;gap:10px}
.videoWrap{position:relative;width:100%;aspect-ratio:3/4;border:1px solid var(--border);border-radius:12px;overflow:hidden;background:#000}
video{position:absolute;inset:0;width:100%;height:100%;object-fit:cover}
canvas{display:none}
.gallery{display:grid;grid-template-columns:repeat(5,minmax(0,1fr));gap:6px;margin-top:10px;contain:content}
.thumb{position:relative;border:1px solid var(--border);border-radius:8px;overflow:hidden;aspect-ratio:1/1;min-width:0;transition:transform .12s ease-out, opacity .12s ease-out;background:#050b18;cursor:pointer}
.thumb.enter{transform:scale(.92);opacity:0}
.thumb.enter.show{transform:scale(1);opacity:1}
.thumb img{width:100%;height:100%;object-fit:cover;display:block}
.badge{position:absolute;top:4px;left:4px;max-width:80%;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;background:#000a;color:#fff;padding:1px 6px;border-radius:7px;font-size:11px}
.modal{position:fixed;inset:0;background:rgba(0,0,0,.9);display:none;align-items:center;justify-content:center;padding:20px}
.modal.open{display:flex}
.modal img{max-width:95vw;max-height:88vh;border-radius:12px;box-shadow:0 12px 48px rgba(0,0,0,.45)}
.modal .close{position:fixed;top:14px;right:14px;background:#000c;color:#fff;border:1px solid #fff6;border-radius:999px;padding:10px 14px;font-size:16px}
@media(max-width:340px){ .gallery{grid-template-columns:repeat(4,minmax(0,1fr));} }
#flash{position:fixed;inset:0;background:#fff;opacity:0;pointer-events:none;transition:opacity 120ms ease}
#toast{position:fixed;left:50%;bottom:18px;transform:translateX(-50%);z-index:9999}
.toast-msg{background:color-mix(in oklab, var(--bg) 86%, #0000);color:var(--ink);border:1px solid var(--border);border-left:6px solid var(--ok);padding:10px 14px;border-radius:12px;box-shadow:0 6px 24px rgba(0,0,0,.25);opacity:0;transform:translateY(8px);transition:all .18s ease}
.toast-msg.err{border-left-color:var(--err)}
.toast-msg.show{opacity:1;transform:translateY(0)}
#progressPanel{position:fixed;left:12px;right:12px;bottom:12px;z-index:9998;display:none}
#progressPanel .wrap{background:var(--outline-bg);border:2px solid color-mix(in oklab, var(--border) 70%, #7aa2ff);border-radius:14px;box-shadow:var(--shadow);padding:10px 12px}
#progressPanel .title{font-weight:700;margin:0 0 8px 0;letter-spacing:.2px}
#progressPanel table{width:100%;border-collapse:separate;border-spacing:0 8px}
#progressPanel th,#progressPanel td{font-size:14px}
#progressPanel th{opacity:.8;text-align:left}
#progressPanel td{background:color-mix(in oklab, var(--bg) 94%, #0000);border:1px solid var(--border);padding:8px 10px;border-radius:10px}
#progressPanel .rowHead{min-width:120px;font-weight:600}
#progressPanel .pct{text-align:right;font-variant-numeric:tabular-nums}
#progressPanel .barWrap{height:10px;border-radius:999px;background:color-mix(in oklab, var(--bg) 85%, #0000);border:1px solid var(--border);overflow:hidden}
#progressPanel .bar{height:100%;width:0%;background:linear-gradient(90deg,#35d0ff,#8cf6ff);transition:width .15s ease}
#logPanel{position:sticky;bottom:0;margin:0 16px 16px;border:1px solid var(--border);border-radius:14px;background:var(--outline-bg)}
#logPanel header{display:flex;gap:8px;align-items:center;justify-content:space-between;padding:8px 12px;border-bottom:1px solid var(--border);position:initial;background:transparent}
#logPanel header h2{font-size:14px;margin:0}
#logTable{width:100%;border-collapse:collapse}
#logTable th,#logTable td{font-size:13px;padding:6px 8px;border-bottom:1px solid var(--border)}
#logTable th{opacity:.8;text-align:left}
#logTable tbody tr:last-child td{border-bottom:none}
